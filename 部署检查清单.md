# 公网部署检查清单

## 部署前准备

- [ ] 购买云服务器（推荐：2核4G，3-5Mbps带宽）
- [ ] 配置安全组/防火墙规则
- [ ] 准备域名（可选，但推荐）
- [ ] 准备 SSL 证书邮箱

## 服务器配置

- [ ] 安装 Node.js 20.x
- [ ] 安装 PostgreSQL
- [ ] 安装 Nginx
- [ ] 安装 PM2
- [ ] 配置防火墙（开放 80, 443, 22 端口）

## 数据库配置

- [ ] 创建数据库 `gsjt`
- [ ] 创建数据库用户
- [ ] 设置强密码
- [ ] 配置仅本地访问（安全）
- [ ] 初始化表结构
- [ ] 导入场景数据

## 应用配置

- [ ] 上传代码到服务器
- [ ] 安装后端依赖
- [ ] 配置后端 `.env` 文件
- [ ] 安装前端依赖
- [ ] 构建前端（`npm run build`）
- [ ] 配置前端 API URL

## 服务配置

- [ ] 使用 PM2 启动后端服务
- [ ] 配置 PM2 开机自启
- [ ] 配置 Nginx 反向代理
- [ ] 配置 SSL 证书（HTTPS）
- [ ] 测试 API 访问
- [ ] 测试前端访问

## 安全配置

- [ ] 修改默认密码
- [ ] 配置防火墙规则
- [ ] 限制 PostgreSQL 仅本地访问
- [ ] 配置数据库备份
- [ ] 设置日志轮转
- [ ] 定期更新系统

## 测试验证

- [ ] 前端页面正常加载
- [ ] API 接口正常响应
- [ ] 测试流程完整运行
- [ ] Admin 页面正常显示
- [ ] 数据正确保存和显示
- [ ] HTTPS 正常工作

## 监控和维护

- [ ] 配置 PM2 监控
- [ ] 配置日志查看
- [ ] 设置数据库自动备份
- [ ] 配置告警通知（可选）

## 常见问题

### 1. 端口被占用
```bash
# 检查端口占用
netstat -tulpn | grep :3001
# 或
lsof -i :3001
```

### 2. PM2 服务未启动
```bash
pm2 status
pm2 logs gsjt-backend
pm2 restart gsjt-backend
```

### 3. Nginx 配置错误
```bash
sudo nginx -t
sudo systemctl status nginx
sudo tail -f /var/log/nginx/error.log
```

### 4. 数据库连接失败
- 检查 `.env` 配置
- 检查 PostgreSQL 服务状态
- 检查用户权限

### 5. 前端无法访问 API
- 检查 Nginx 代理配置
- 检查 CORS 设置
- 检查 API URL 配置
